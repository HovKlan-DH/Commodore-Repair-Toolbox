<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CRT"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="CRT.Main"
        Title="Commodore Repair Toolbox"
        MinWidth="800"
        MinHeight="500">

    <Window.Styles>

        <!-- Base tab font size and reduced vertical padding -->
        <Style Selector="TabItem">
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Padding" Value="12,4" />
        </Style>

        <!-- Hover: tint the header text -->
        <Style Selector="TabItem:pointerover">
            <Setter Property="Foreground" Value="IndianRed" />
        </Style>

        <!-- Hover: show a faint underline indicator -->
        <Style Selector="TabItem:pointerover /template/ Border#PART_SelectedPipe">
            <Setter Property="IsVisible" Value="True" />
            <Setter Property="Background" Value="LightCoral" />
        </Style>

        <!-- Selected: solid underline indicator -->
        <Style Selector="TabItem:selected /template/ Border#PART_SelectedPipe">
            <Setter Property="Background" Value="IndianRed" />
        </Style>

        <!-- Banner install button: explicit hover/pressed backgrounds -->
        <Style Selector="Button.BannerInstallButton /template/ ContentPresenter">
            <Setter Property="Background" Value="IndianRed" />
        </Style>
        <Style Selector="Button.BannerInstallButton:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#C05050" />
        </Style>
        <Style Selector="Button.BannerInstallButton:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="#8B2020" />
        </Style>

        <!-- Banner dismiss button: subtle hover on dark background -->
        <Style Selector="Button.BannerDismissButton /template/ ContentPresenter">
            <Setter Property="Background" Value="Transparent" />
        </Style>
        <Style Selector="Button.BannerDismissButton:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#6B2020" />
        </Style>
        <Style Selector="Button.BannerDismissButton:pressed /template/ ContentPresenter">
            <Setter Property="Background" Value="#4C1515" />
        </Style>

    </Window.Styles>

    <Grid x:Name="RootGrid">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200" MinWidth="80" />
            <ColumnDefinition Width="4" />
            <ColumnDefinition Width="*" MinWidth="100" />
        </Grid.ColumnDefinitions>

        <!-- Left Panel -->
        <Border x:Name="LeftPanel"
                Grid.Column="0"
                BorderBrush="IndianRed"
                BorderThickness="1"
                Padding="16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!-- Size label -->
                <TextBlock x:Name="LeftSizeLabel"
                           Grid.Row="0"
                           HorizontalAlignment="Right"
                           VerticalAlignment="Top"
                           FontSize="11"
                           Foreground="Gray" />

                <!-- Hardware, Board and Category selectors -->
                <Grid Grid.Row="1"
                      Margin="0,8,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                               Text="Hardware"
                               FontSize="11"
                               Foreground="Gray" />
                    <ComboBox Grid.Row="1"
                              x:Name="HardwareComboBox"
                              HorizontalAlignment="Stretch"
                              Margin="0,4,0,0" />
                    <TextBlock Grid.Row="2"
                               Text="Board"
                               FontSize="11"
                               Foreground="Gray"
                               Margin="0,8,0,0" />
                    <ComboBox Grid.Row="3"
                              x:Name="BoardComboBox"
                              HorizontalAlignment="Stretch"
                              Margin="0,4,0,0" />
                    <TextBlock Grid.Row="4"
                               Text="Category"
                               FontSize="11"
                               Foreground="Gray"
                               Margin="0,8,0,0" />
                    <ListBox Grid.Row="5"
                             x:Name="CategoryFilterListBox"
                             SelectionMode="Multiple,Toggle"
                             Margin="0,4,0,0"
                             Background="White"
                             BorderBrush="Gray"
                             BorderThickness="1"
                             CornerRadius="4"
                             ClipToBounds="True"
                             Padding="0"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.Styles>
                            <Style Selector="ListBox /template/ Border">
                                <Setter Property="CornerRadius" Value="3" />
                                <Setter Property="ClipToBounds" Value="True" />
                            </Style>
                            <Style Selector="ListBox /template/ ScrollViewer">
                                <Setter Property="CornerRadius" Value="3" />
                                <Setter Property="ClipToBounds" Value="True" />
                            </Style>
                            <Style Selector="ListBoxItem">
                                <Setter Property="Padding" Value="8,3" />
                                <Setter Property="MinHeight" Value="0" />
                                <Setter Property="FontSize" Value="11" />
                            </Style>
                            <Style Selector="ListBoxItem:pointerover /template/ ContentPresenter">
                                <Setter Property="Background" Value="SkyBlue" />
                            </Style>
                            <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
                                <Setter Property="Background" Value="LightBlue" />
                            </Style>
                            <Style Selector="ListBoxItem:selected">
                                <Setter Property="Foreground" Value="White" />
                            </Style>
                            <Style Selector="ListBoxItem:selected:pointerover /template/ ContentPresenter">
                                <Setter Property="Background" Value="SkyBlue" />
                            </Style>
                            <Style Selector="ListBoxItem:selected:pointerover">
                                <Setter Property="Foreground" Value="White" />
                            </Style>
                        </ListBox.Styles>
                    </ListBox>

                    <TextBlock Grid.Row="6"
                               Text="Component"
                               FontSize="11"
                               Foreground="Gray"
                               Margin="0,8,0,0" />
                    <ListBox Grid.Row="7"
                             x:Name="ComponentFilterListBox"
                             SelectionMode="Multiple,Toggle"
                             Margin="0,4,0,0"
                             Background="White"
                             BorderBrush="Gray"
                             BorderThickness="1"
                             CornerRadius="4"
                             ClipToBounds="True"
                             Padding="0"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.Styles>
                            <Style Selector="ListBox /template/ Border">
                                <Setter Property="CornerRadius" Value="3" />
                                <Setter Property="ClipToBounds" Value="True" />
                            </Style>
                            <Style Selector="ListBox /template/ ScrollViewer">
                                <Setter Property="CornerRadius" Value="3" />
                                <Setter Property="ClipToBounds" Value="True" />
                            </Style>
                            <Style Selector="ListBoxItem">
                                <Setter Property="Padding" Value="8,3" />
                                <Setter Property="MinHeight" Value="0" />
                                <Setter Property="FontSize" Value="11" />
                            </Style>
                            <Style Selector="ListBoxItem:pointerover /template/ ContentPresenter">
                                <Setter Property="Background" Value="SkyBlue" />
                            </Style>
                            <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
                                <Setter Property="Background" Value="LightBlue" />
                            </Style>
                            <Style Selector="ListBoxItem:selected">
                                <Setter Property="Foreground" Value="White" />
                            </Style>
                            <Style Selector="ListBoxItem:selected:pointerover /template/ ContentPresenter">
                                <Setter Property="Background" Value="SkyBlue" />
                            </Style>
                            <Style Selector="ListBoxItem:selected:pointerover">
                                <Setter Property="Foreground" Value="White" />
                            </Style>
                        </ListBox.Styles>
                    </ListBox>
                </Grid>

            </Grid>
        </Border>

        <!-- Left Splitter -->
        <GridSplitter x:Name="MainSplitter"
                      Grid.Column="1"
                      ResizeDirection="Columns"
                      HorizontalAlignment="Stretch"
                      Background="Gray" />

        <!-- Right Panel -->
        <Border x:Name="RightPanel"
                Grid.Column="2"
                BorderBrush="White"
                BorderThickness="1"
                Padding="0,0,0,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!-- Update notification banner -->
                <Border x:Name="UpdateBanner"
                        Grid.Row="0"
                        IsVisible="False"
                        Background="#4C1515"
                        CornerRadius="4"
                        Margin="0,8,0,4"
                        Padding="12,6">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock x:Name="UpdateBannerText"
                                   Grid.Column="0"
                                   VerticalAlignment="Center"
                                   Foreground="White"
                                   FontSize="12" />

                        <Button x:Name="UpdateBannerInstallButton"
                                Grid.Column="1"
                                Classes="BannerInstallButton"
                                Content="Install"
                                Margin="12,0,4,0"
                                Background="IndianRed"
                                Foreground="White"
                                FontSize="11"
                                Padding="10,3"
                                Click="OnInstallUpdateClick" />

                        <Button x:Name="UpdateBannerDismissButton"
                                Grid.Column="2"
                                Classes="BannerDismissButton"
                                Content="✕"
                                Background="Transparent"
                                Foreground="White"
                                FontSize="11"
                                Padding="6,3"
                                Click="OnUpdateBannerDismiss" />
                    </Grid>
                </Border>

                <!-- Data sync notification banner -->
                <Border x:Name="SyncBanner"
                        Grid.Row="1"
                        IsVisible="False"
                        Background="#4C1515"
                        CornerRadius="4"
                        Margin="0,0,0,4"
                        Padding="12,6"
                        Cursor="Hand"
                        PointerPressed="OnSyncBannerPointerPressed">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock x:Name="SyncBannerText"
                                   Grid.Column="0"
                                   VerticalAlignment="Center"
                                   Foreground="White"
                                   FontSize="12" />

                        <Button x:Name="SyncBannerDismissButton"
                                Grid.Column="1"
                                Classes="BannerDismissButton"
                                Content="✕"
                                Background="Transparent"
                                Foreground="White"
                                FontSize="11"
                                Padding="6,3"
                                Click="OnSyncBannerDismiss" />
                    </Grid>
                </Border>

                <TabControl Grid.Row="2">

                    <TabItem Header="Schematics">
                        <Grid x:Name="SchematicsInnerGrid">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" MinWidth="80" />
                                <ColumnDefinition Width="4" />
                                <ColumnDefinition Width="*" MinWidth="100" />
                            </Grid.ColumnDefinitions>

                            <!-- Schematics Image Panel (zoomable) -->
                            <Border Grid.Column="0"
                                    x:Name="SchematicsContainer"
                                    ClipToBounds="True"
                                    PointerWheelChanged="OnSchematicsZoom"
                                    PointerPressed="OnSchematicsPointerPressed"
                                    PointerMoved="OnSchematicsPointerMoved"
                                    PointerReleased="OnSchematicsPointerReleased"
                                    Padding="0,0,0,0"
                                    >
                                <Grid>
                                    <Image x:Name="SchematicsImage"
                                           Stretch="Uniform"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Top"
                                           RenderTransformOrigin="0%,0%"
                                           RenderOptions.BitmapInterpolationMode="HighQuality">
                                        <Image.RenderTransform>
                                            <MatrixTransform />
                                        </Image.RenderTransform>
                                    </Image>

                                    <local:SchematicHighlightsOverlay x:Name="SchematicsHighlightsOverlay"
                                                                     IsHitTestVisible="False"
                                                                     RenderTransformOrigin="0%,0%">
                                        <local:SchematicHighlightsOverlay.RenderTransform>
                                            <MatrixTransform />
                                        </local:SchematicHighlightsOverlay.RenderTransform>
                                    </local:SchematicHighlightsOverlay>
                                </Grid>
                            </Border>

                            <!-- Schematics Splitter -->
                            <GridSplitter x:Name="SchematicsSplitter"
                                          Grid.Column="1"
                                          ResizeDirection="Columns"
                                          HorizontalAlignment="Stretch"
                                          Background="Gray" />

                            <!-- Schematics Right Content - Thumbnail Gallery -->
                            <ListBox x:Name="SchematicsThumbnailList"
                                     Grid.Column="2"
                                     Background="Transparent"
                                     SelectionMode="Single"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled">

                                <ListBox.Styles>

                                    <!-- Remove default pointer-over and selection backgrounds -->
                                    <Style Selector="ListBoxItem:pointerover /template/ ContentPresenter">
                                        <Setter Property="Background" Value="Transparent" />
                                    </Style>
                                    <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
                                        <Setter Property="Background" Value="Transparent" />
                                    </Style>

                                    <!-- Ensure each item stretches to fill the full panel width -->
                                    <Style Selector="ListBoxItem">
                                        <Setter Property="Padding"                     Value="0" />
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                    </Style>

                                    <!-- Default thumbnail border: 1px black -->
                                    <Style Selector="ListBoxItem Border.ThumbnailBorder">
                                        <Setter Property="BorderBrush"     Value="Black" />
                                        <Setter Property="BorderThickness" Value="1" />
                                    </Style>

                                    <!-- Selected thumbnail border: thicker IndianRed -->
                                    <Style Selector="ListBoxItem:selected Border.ThumbnailBorder">
                                        <Setter Property="BorderBrush"     Value="IndianRed" />
                                        <Setter Property="BorderThickness" Value="3" />
                                    </Style>

                                </ListBox.Styles>
                                <ListBox.ItemTemplate>
                                    <DataTemplate x:DataType="local:SchematicThumbnail">
                                        <Border Classes="ThumbnailBorder"
                                                Margin="4,4,8,4"
                                                CornerRadius="0"
                                                HorizontalAlignment="Stretch"
                                                ClipToBounds="True">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="*" />
                                                </Grid.RowDefinitions>
                                                
                                                <Border Grid.Row="0"
                                                        Background="Khaki"
                                                        BorderBrush="Black"
                                                        BorderThickness="0,0,0,1">
                                                    <TextBlock Text="{Binding Name}"
                                                               HorizontalAlignment="Stretch"
                                                               TextAlignment="Left"
                                                               FontSize="11"
                                                               Padding="4,3" />
                                                </Border>
                                                
                                                <Image Grid.Row="1"
                                                       Source="{Binding ImageSource}"
                                                       Stretch="Uniform"
                                                       HorizontalAlignment="Stretch"
                                                       RenderOptions.BitmapInterpolationMode="HighQuality" />
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>

                        </Grid>
                    </TabItem>

                    <TabItem Header="Overview">
                        <StackPanel Spacing="16"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center">

                            <TextBlock x:Name="RightSizeLabel"
                               HorizontalAlignment="Right"
                               VerticalAlignment="Top"
                               FontSize="11"
                               Foreground="Gray" />

                            <Button x:Name="MyButton"
                                    Content="Click me!"
                                    Click="OnMyButtonClick"
                                    Background="LightBlue" />
                            <TextBlock x:Name="StatusText"
                                       Text="Waiting for click..."
                                       Background="LightYellow"
                                       Foreground="DarkBlue"
                                       HorizontalAlignment="Center" />
                        </StackPanel>
                    </TabItem>

                    <TabItem Header="Resources">
                        <TextBlock Text="Details content goes here"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center" />
                    </TabItem>

                    <TabItem Header="Configuration">
                        <StackPanel Spacing="8"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Margin="16">

                            <TextBlock Text="Application Launch"
                                       FontSize="12"
                                       FontWeight="SemiBold"
                                       Margin="0,0,0,4" />

                            <CheckBox x:Name="CheckVersionOnLaunchCheckBox"
                                      Content="Check for new version at application launch" />

                            <CheckBox x:Name="CheckDataOnLaunchCheckBox"
                                      Content="Check for new or updated data at application launch" />

                        </StackPanel>
                    </TabItem>

                    <TabItem Header="Feedback">
                        <TextBlock Text="Details content goes here"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center" />
                    </TabItem>

                    <TabItem Header="Help">
                        <TextBlock Text="Details content goes here"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center" />
                    </TabItem>

                    <TabItem Header="About">
                        <StackPanel Spacing="12"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    MaxWidth="360">

                            <TextBlock Text="Commodore Repair Toolbox"
                                       FontSize="16"
                                       FontWeight="SemiBold"
                                       HorizontalAlignment="Center" />

                            <TextBlock x:Name="AppVersionText"
                                       FontSize="11"
                                       Foreground="Gray"
                                       HorizontalAlignment="Center" />

                        </StackPanel>
                    </TabItem>

                </TabControl>

            </Grid>
        </Border>

    </Grid>

</Window>